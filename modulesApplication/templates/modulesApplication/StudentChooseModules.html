{% extends "modulesApplication/base.html" %}
{% load static %}

{% block title %}Choose Modules{% endblock %}

{% block css %}
    {{ block.super }}
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'modulesApplication/css/choosemodules.css' %}">
{% endblock %}

{% block sidebar-links %}
    <li><a href="{% url 'modulesApplication:student-landing' %}" class="btn"><i
            class="fas fa-home"></i>home</a></li>
    <li><a href="{% url 'modulesApplication:choose-modules' %}" class="btn"><i class="fas fa-book-open"></i>choose
        modules</a></li>
    <li><a href="{% url 'modulesApplication:all-modules' %}" class="btn"><i class="fas fa-book-open"></i>all
        courses</a></li>
{% endblock %}

{% block content %}
    <div class="page-wrapper">
        <!-- IMAGE BAR -->
        <div class="image-box">
            <div class="ib-content">
                <h2><i class="fas fa-book-open"></i> choose modules</h2> <br>
            </div>
        </div>

        <!-- FORM -->
        <div class="form-box">
            <div class="icon-img">
                <i class="fas fa-book-open"></i>
            </div>

            <form id="form_id" action="{% url 'modulesApplication:choose-modules' %}" method="POST">
                {% csrf_token %}
                <h1>Module Choice Form</h1>
                <label for="programme_filter">Please select your degree programme: </label>
                <br>

                <select name="programme" id="programme_filter" class="dropdown">
                    <option value="" selected disabled>Choose here...</option>
                </select>

                <br>

                <label for="stage_filter"> Please select your degree stage: </label>
                <br>

                <select name="stage" id="stage_filter" class="dropdown">
                    <option value="" selected disabled>Choose here...</option>
                </select>

                <br>

                <input type="submit" value="confirm">
                <br>
            </form>

        </div>
    </div>    
    
    <!-- DROPDOWN SCRIPT -->
<script>
    //from programmes table : title,prog_code
    const programmes = {
        "BSc Computer Science": "1067",
        "BSc Computer Science with a Year in Industry": "2327",
        "BSc Computer Science (Artificial Intelligence)": "1059",
        "BSc Computer Science (Artificial Intelligence) with a Year in Industry": "2446",
        "BSc Computer Science (Information Security)": "2675",
        "BSc Computer Science (Information Security) with a Year in Industry": "2676",
        "BSc Computer Science (Software Engineering)": "2843",
        "BSc Computer Science (Software Engineering) with a Year in Industry": "2844",
        "BSc Computer Science (Distributed and Networked Systems)": "3014",
        "BSc Computer Science (Distributed and Networked Systems) with a Year in Industry": "3015",
        "BSc Computer Science and Mathematics": "1069",
        "BSc Computer Science with Management": "1062",
        "BSc Computing Technologies": "3424",
        "BSc Computing and Business": "1257",
        "BSc Computer Science with Integrated Foundation Year": "3449",
        "MSci Computer Science": "2686",
        "MSci Computer Science with a Year in Industry": "2687",
        "MSci Computer Science (Artificial Intelligence)": "2673",
        "MSci Computer Science (Artificial Intelligence) with a Year in Industry": "2674",
        "MSci Computer Science (Information Security)": "2677",
        "MSci Computer Science (Information Security) with a Year in Industry": "2678",
        "MSci Computer Science (Software Engineering)": "2845",
        "MSci Computer Science (Software Engineering) with a Year in Industry": "2846",
        "MSci Computer Science (Distributed and Networked Systems)": "3016",
        "MSci Computer Science (Distributed and Networked Systems) with a Year in Industry": "3017"
    };

    const programmes_stage = {
        "1067": "3",
        "1059": "3",
        "2675": "3",
        "2843": "3",
        "3014": "3",
        "1069": "3",
        "1062": "3",
        "3424": "3",
        "1257": "3",
        "2327": "4",
        "2844": "4",
        "2676": "4",
        "3015": "4",
        "2446": "4",
        "3449": "4",
        "2686": "4",
        "2673": "4",
        "2677": "4",
        "2845": "4",
        "3016": "4",
        "2687": "5",
        "2678": "5",
        "2674": "5",
        "2846": "5",
        "3017": "5"
    }
    const stage = {
        "Year One": "1",
        "Year Two": "2",
        "Year Three": "3",
        "Year Four": "4",
        "Year Five": "5"
    };

    const programSel = document.getElementById("programme_filter");
    const stageSel = document.getElementById("stage_filter");

    window.onload = function () {
        for (let key in programmes) {
            console.log(programmes[key])
            programSel.options[programSel.options.length] = new Option(key, programmes[key]);
        }
    }

    programSel.onchange = function () {
        let programme = programSel.value
        stageSel.length = 1;
        for (let key in stage) {
            console.log(programmes_stage[key])
            stageSel.options[stageSel.options.length] = new Option(key, stage[key]);
            if (stage[key] === programmes_stage[programme]) {
                break
            }
        }
    }
    window.addEventListener("pageshow", function (event) {
        let reloaded = event.persisted ||
            (typeof window.performance != "undefined"&&
                              window.performance.navigation.type >= 2);
        if (reloaded) {
            // Handle page restore.
            window.location.reload();
        }
    });

</script>
{% endblock %}

